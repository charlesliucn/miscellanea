#1.	使用 CREATE语句在数据库 STUDENT中建立以上三个基本表，并分别为其第一列。
CREATE TABLE DEPT(
	DEPTNO INTEGER PRIMARY KEY,
	DNAME VARCHAR(18) NOT NULL,
	HEAD CHAR(10) NOT NULL
);
CREATE INDEX DE ON DEPT(DEPTNO);

CREATE TABLE STU(
	STNO CHAR(10) PRIMARY KEY,
	NAME VARCHAR(20) NOT NULL,
	AGE INTEGER NOT NULL,
	MONIT CHAR(10) NOT NULL,
	MACR INTEGER NOT NULL,
	MICR INTEGER,#	NULL?
	EDATA DATETIME NOT NULL,
	DEPTNO INTEGER NOT NULL #FOREIGN KEY REFERENCES DEPT(DEPTNO)
);
CREATE INDEX ST ON STU(STNO);

CREATE TABLE TEACHER(
	TNO CHAR(10) PRIMARY KEY,
	NAME VARCHAR(20) NOT NULL,
	AGE INTEGER NOT NULL,
	WDATA DATETIME NOT NULL,
	DEPTNO INTEGER NOT NULL #FOREIGN KEY REFERENCES DEPT(DEPTNO)
);
CREATE INDEX TE ON TEACHER(TNO);

#2.	
DROP INDEX DE;
DROP INDEX ST;
DROP INDEX TE;
#DROP INDEX DEPT.DE;
#DROP INDEX STU.ST;
#DROP INDEX TEACHER.TE;
DROP TABLE DEPT;
DROP TABLE STU;
DROP TABLE TEACHER;

#3.	
#1)	向DEPT中插入数据：
INSERT INTO DEPT VALUES(19, 'PHYSICS', '2001190001');
INSERT INTO DEPT VALUES(20, 'ENGLISH', '1993200060');
INSERT INTO DEPT VALUES(23, 'MATHEMATICS', '1995230010');
INSERT INTO DEPT VALUES(34, 'EE', '1998340034');
INSERT INTO DEPT VALUES(44, 'CS', '1996440050');

#2)	
INSERT INTO STU VALUES('2014340001', 'LIU YU', 21, '2014346666', 21, 12, '09-01-2014', 34);
INSERT INTO STU VALUES('2014340002', 'YANG SHEN', 20, '2014346666', 20,  , '09-01-2014', 34);
INSERT INTO STU VALUES('2014346666', 'ZHENG YAO', 21, '2014346666',  20, 4, '09-01-2014', 34);
INSERT INTO STU VALUES('2014340047', 'PAN JIANG', 19, '2014346666', 18,  , '09-01-2014', 34);

INSERT INTO STU VALUES('2014440050', 'CHEN KUN', 20, '2014448888', 18, 5 , '09-01-2014', 44);
INSERT INTO STU VALUES('2014448888', 'GE XIN', 21, '2014448888',  28,  , '09-01-2014', 44);


INSERT INTO STU VALUES('2013230110', 'SHAO PENG', 21, '2013231111', 15,  , '09-01-2013', 23);
INSERT INTO STU VALUES('2014230101', 'XIAO HONG', 20, '2014230101',  20, 3, '09-01-2014', 23);
INSERT INTO STU VALUES('2013230047', 'PAN JIANG', 23, '2013231111', 18,  , '09-01-2013', 23);
INSERT INTO STU VALUES('2013231111', 'MA GE', 23, '2013231111',  20, 3, '09-01-2013', 23);


INSERT INTO STU VALUES('2013200158', 'SHEN QING', 23, '2013202222', 17,  , '09-01-2013', 20);
INSERT INTO STU VALUES('2013202222', 'LI GANG', 22, '2013202222',  17, 4, '09-01-2013', 20);
INSERT INTO STU VALUES('2014200366', 'SUN YU', 23, '2014200202', 20,  , '09-01-2014', 20);
INSERT INTO STU VALUES('2014200202', 'ZHAO TONG', 22, '2014200202', 20,  , '09-01-2014', 20);

INSERT INTO STU VALUES('2014190233', 'WANG DONG', 21, '2014193333',  18,  , '09-01-2014', 19);
INSERT INTO STU VALUES('2014193333', 'FENG ZHENG', 21, '2014193333',  15,  , '09-01-2014', 19);

#3)	
INSERT INTO TEACHER VALUES('1999192026','ZHANG SAN', 45, '08-01-1999', 19) ;
INSERT INTO TEACHER VALUES('2001190001','LI SI', 42, '08-01-2001', 19) ;

INSERT INTO TEACHER VALUES('1998203032','WANG WU', 50, '08-01-1998', 20) ;
INSERT INTO TEACHER VALUES('1993200060','SUN LIU', 55, '08-01-1993', 20) ;

INSERT INTO TEACHER VALUES('1995230010','YI YI', 51, '08-01-1995', 23) ;
INSERT INTO TEACHER VALUES('1990230010','QIAN SEN', 60, '08-01-1990', 23) ;

INSERT INTO TEACHER VALUES('1998340034', 'ZHOU HAO', 44, '08-01-1998', 34);
INSERT INTO TEACHER VALUES('2000341516', 'SHEN ZE', 45, '08-01-2000', 34);

INSERT INTO TEACHER VALUES('1996440050','WU TIAN', 48, '08-01-1996', 44)
INSERT INTO TEACHER VALUES('19992028','JIANG HANG', 40, '08-01-1999', 44);

#4.	SELECT语句查询：
#(1)
SELECT *
FROM DEPT;

#(2)
SELECT NAME, AGE, MACR
FROM STU
ORDER BY MACR DESC;

#(3)
SELECT NAME
FROM STU
WHERE DEPTNO = 23;

#(4)
SELECT NAME
FROM STU
WHERE EDATE BETWEEN '01-01-2012' AND '01-01-2014';

#(5)
SELECT DEPTNO, COUNT(*) AS COUNT, AVG(MACR+ISNULL(MICR,0)) AS AVERAGE
FROM STU
GROUP BY DEPTNO;

#(6)
SELECT *
FROM STU
WHERE DEPTNO = 20 AND MACR > 
(	SELECT AVG(MACR)
	FROM STU
	WHERE DEPTNO = 20
);
#注意一开始写成了MACR > AVG(MACR)，这样的话对AVG的结果是所有学生的平均主修分数
#而不是DEPTNO = 20的平均主修分

#(7)
SELECT *
FROM STU
WHERE DEPTNO = 23 AND ETIME =
(	SELECT MIN(ETIME)
	FROM STU
	WHERE DEPT = 23
);

#WHERE ETIME = MIN(ETIME) AND DEPTNO = 23;
#查询入学时间最早且系编号为23的学生信息，注意原本写的是ETIME = MIN(ETIME) AND DEPTNO = 23;
#这样的话输出可能没有结果，因而入学最早的系编号不一定为23，但原题的意思与此不同，应当是院系号为23的入学时间最早的学生。

#(8)	 	
SELECT DEPT.DNAME, DEPT.DEPTNO
FROM DEPT, STU
WHERE STU.NAME = 'WANG DONG'
	AND STU.DEPTNO = DEPT. DEPTNO;

#(9)	 	
SELECT FIRST.STNO,FIRST.NAME
FROM STU FIRST
WHERE MACR >
(	SELECT SECOND.MACR
	FROM FIRST, SECOND
	WHERE FIRST.MONIT = SECOND.STNO
);
#SELECT STNO,NAME
#ROM STU A
#WHERE MACR>=
#(	SELECT MACR
#	FROM STU B
#	WHERE A.MONIT=B.STNO
#);

#(10)
SELECT STNO, NAME
FROM STU
WHERE DEPTNO = 
(	SELECT DEPTNO
	FROM TEACHER
	WHERE NAME = 'ZHANG SAN'
);

#(11)
SELECT A.NAME, DEPT.DNAME
FROM DEPT,TEACHER A
WHERE DEPT.DEPTNO = A.DEPTNO
AND A.WDATE >
(	SELECT WDATA
	FROM TEACHER B
	WHERE B.TNO = 
	(	SELECT DEPT.HEAD
		FROM DEPT, TEACHER
		WHERE DEPT.DEPTNO = A.DEPTNO
	)
);
#SELECT NAME,DNAME
#FROM TEACHER A,DEPT C
#WHERE WDATE<
#SELECT WDATE
#FROM TEACHER B
#WHERE B.TNO IN
#(SELECT DNAME
#FROM DEPT D
#WHERE D.DEPTNO=A.DEPTNO AND C.DNAME=D.DNAME));


#5 . 
#a.	
CREATE VIEW EE_STU
AS SELECT *
FROM STU
WHERE DEPTNO = 
(	SELECT DEPTNO
	FROM DEPT
	WHERE DNAME = 'EE'
);

#b.
CREATE VIEW DEPT_VIEW
AS SELECT DEPT.DEPTNO, DEPT.DNAME, TEACHER.NAME
	FROM DEPT, TEACHER
	WHERE DEPT.HEAD = TEACHER.TNO
		AND DEPT.DEPTNO = TEACHER.DEPTNO;

#c.	 	
SELECT *
FROM EE_STU
WHERE MACR = MAX(MACR);

#d.	 	
SELECT *
FROM DEPT_VIEW;

#e.	 	
DROP VIEW EE_STU;
DROP VIEW DEPT_VIEW;